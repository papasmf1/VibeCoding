# 코스피200 편입종목상위 크롤러 (GUI 버전)

PyQt5를 사용하여 만든 그래픽 사용자 인터페이스(GUI) 버전의 코스피200 편입종목상위 크롤러입니다.

## 주요 기능

### 🖥️ GUI 인터페이스
- **직관적인 사용자 인터페이스**: 마우스 클릭으로 쉽게 조작 가능
- **실시간 진행 상황 표시**: 크롤링 진행 상황을 실시간으로 확인
- **데이터 테이블 표시**: 수집된 데이터를 보기 좋은 테이블 형태로 표시
- **로그 창**: 크롤링 과정의 상세한 로그 확인

### 🔍 종목 검색 기능
- **실시간 검색**: 수집된 데이터에서 특정 종목을 빠르게 검색
- **부분 검색**: 종목명의 일부만 입력해도 검색 가능
- **검색 결과 표시**: 검색된 종목 수와 결과를 즉시 확인

### 📊 데이터 관리
- **CSV 파일 저장**: 수집된 데이터를 CSV 형식으로 저장
- **엑셀 파일 저장**: 수집된 데이터를 엑셀(.xlsx) 형식으로 저장 (스타일링 포함)
- **테이블 새로고침**: 데이터를 다시 표시
- **다중 페이지 크롤링**: 최대 20페이지까지 순차적으로 크롤링

## 설치 방법

1. 필요한 라이브러리 설치:
```bash
pip install -r requirements.txt
```

2. GUI 크롤러 실행:
```bash
python kospi200_gui_crawler.py
```

## 사용 방법

### 1. 크롤링 시작
1. **크롤링할 페이지 수** 설정 (1-20페이지)
2. **"크롤링 시작"** 버튼 클릭
3. 진행 상황을 실시간으로 확인

### 2. 종목 검색
1. **종목명 입력창**에 검색할 종목명 입력 (예: "삼성전자")
2. **"검색"** 버튼 클릭 또는 Enter 키 입력
3. 검색 결과가 테이블에 표시됨

### 3. 데이터 저장
#### CSV 저장
1. 크롤링 완료 후 **"CSV 저장"** 버튼 클릭
2. 저장할 위치와 파일명 선택
3. UTF-8 인코딩으로 한글이 깨지지 않게 저장

#### 엑셀 저장
1. 크롤링 완료 후 **"엑셀에 저장"** 버튼 클릭
2. 저장할 위치와 파일명 선택
3. 엑셀 파일에 다음이 포함됩니다:
   - **코스피200_편입종목 시트**: 상세 데이터 (스타일링 포함)
   - **요약정보 시트**: 데이터 요약 정보

### 4. 기타 기능
- **"중지"** 버튼: 크롤링 중간에 중단
- **"테이블 새로고침"** 버튼: 테이블 데이터 다시 표시
- **"종료"** 버튼: 프로그램 종료

## 화면 구성

### 상단 영역
- **종목 검색**: 종목명 입력창과 검색 버튼
- **크롤링 설정**: 페이지 수 설정과 크롤링 시작/중지 버튼

### 중앙 영역
- **진행 상황**: 크롤링 진행 상황과 로그 표시
- **데이터 테이블**: 수집된 종목 데이터를 표 형태로 표시
- **크롤링 로그**: 상세한 크롤링 과정 로그

### 하단 영역
- **데이터 관리 버튼**: CSV 저장, 엑셀 저장, 테이블 새로고침, 종료

## 수집되는 정보

- **종목명**: 주식 종목의 이름
- **현재가**: 현재 주가
- **전일비**: 전일 대비 등락폭 (상승/하락/보합)
- **등락률**: 전일 대비 등락률 (%)
- **거래량**: 일일 거래량
- **거래대금**: 일일 거래대금 (백만원 단위)
- **시가총액**: 시가총액 (억원 단위)

## 주의사항

- **서버 부하 방지**: 페이지 간 1초 딜레이 자동 적용
- **네트워크 연결**: 인터넷 연결이 필요합니다
- **한글 인코딩**: UTF-8로 저장되어 한글이 깨지지 않습니다
- **데이터 참고용**: 수집된 데이터는 참고용으로만 사용하세요

## 기술적 특징

- **멀티스레딩**: 크롤링 작업을 별도 스레드에서 실행하여 UI 응답성 보장
- **실시간 업데이트**: 진행 상황을 실시간으로 표시
- **오류 처리**: 네트워크 오류나 기타 예외 상황에 대한 적절한 처리
- **메모리 효율성**: 대용량 데이터 처리 시 메모리 사용량 최적화
- **엑셀 스타일링**: openpyxl을 사용한 전문적인 엑셀 파일 생성

## 문제 해결

### GUI가 실행되지 않는 경우
1. PyQt5 설치 확인: `pip install PyQt5`
2. Python 버전 확인: Python 3.6 이상 필요

### 크롤링이 실패하는 경우
1. 인터넷 연결 확인
2. 네이버 금융 서버 상태 확인
3. 방화벽 설정 확인

### 데이터가 표시되지 않는 경우
1. 크롤링 완료 여부 확인
2. "테이블 새로고침" 버튼 클릭
3. 로그 창에서 오류 메시지 확인 